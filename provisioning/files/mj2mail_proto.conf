upstream rails-unicorn {
    server unix:/var/share/unicorn.sock;
}

server {
    listen   80; ## listen for ipv4; this line is default and implied
    #listen   [::]:80 default ipv6only=on; ## listen for ipv6

#   root /usr/share/nginx/www;
    index index.php index.html index.htm;

    # Make site accessible from http://localhost/
    server_name localhost;

    location /mj2mail_proto/ {
        try_files $uri $uri.html $uri/index.html @rails-unicorn;
    }
    location ~ ^/assets/(.*) {
        alias /home/vagrant/mj2mail_proto/public/assets/$1;
    }

    location @rails-unicorn {
               proxy_set_header X-Real-IP $remote_addr;
               proxy_set_header X-Forwarded_For $proxy_add_x_forwarded_for;
               proxy_set_header Host $http_host;
               proxy_pass http://rails-unicorn;
    }

    # Only for nginx-naxsi : process denied requests
    #location /RequestDenied {
        # For example, return an error code
        #return 418;
    #}

    error_page 404 /404.html;

    # redirect server error pages to the static page /50x.html
    #
    error_page 500 502 503 504 /50x.html;
    location = /50x.html {
        root /usr/share/nginx/www;
    }

}

